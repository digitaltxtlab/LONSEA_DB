{
    "collab_server" : "",
    "contents" : "#!/usr/bin/Rscript\n\n#\"\"\"\n# import LONSEA projects original data and remove objects that are not LoN and General Assembly \n# clean nationality and replace empty entries with NA\n#\"\"\"\n\nrm(list = ls())\nrequire(stringr)\n\ndat.df <- read.csv(\"data/sheet1.csv\", stringsAsFactors = FALSE)\n# features\nvarnames <- colnames(dat.df)\n# reduce data set to LoN minus General Assembly\ni <- 1:nrow(dat.df)# numerical index for generation of final data set\n# LoN ids\nlon_idx <- !is.na(str_match(dat.df$oname,'LoN'))\nlon_id = dat.df$oname[lon_idx] \ni <- i[lon_idx]\n# general assembly ids\nnaga_idx <- is.na(str_match(lon_id,'General Assembly'))\nnaga_id <- lon_id[naga_idx]\ni <- i[naga_idx]\n# export data\ndat2.df <- dat.df[i,]\n# write.csv(dat2.df, file = \"data/lon_data.csv\")\n# remove \"IoN \" in fname,canonical_fname,oname\nfor(ii in 4:6){\n  dat2.df[,ii] <- str_replace(dat2.df[,ii],\"LoN \",\"\")\n  }\nhead(dat2.df)\n#write.csv(dat2.df, file = \"data/lon_data.csv\")\n\n# split nationality and transform to country name instead of nationality (for geo-mapping)\ndat2.df$nationality <- str_replace(dat2.df$nationality,\"\\t\",\"\")\ndat2.df$nationality <- str_replace(dat2.df$nationality,\"New Zealander\",\"New_Zealander\")\ndat2.df$nationality <- str_replace(dat2.df$nationality,\"South African\",\"South_African\")\ndat2.df$nationality <- str_replace(dat2.df$nationality,\"Costa Rican\",\"Costa_Rican\")\ndat2.df$nationality <- str_replace(dat2.df$nationality,\" \",\"\")\n# build list\nnation.l <- dat2.df$nationality\n# replace empty entries with NA\nnation.l[which(nation.l == \"\")] = NA\n# build matrix\nnation.m <- matrix(data=NA,nrow=length(nation.l),ncol=3)\ncolnames(nation.m) <- c('nation_1','nation_2','nation_3')\nfor(i in 1:length(nation.l)){\n  tmp <- unlist(strsplit(nation.l[i],\",\")) \n  for(ii in 1:length(tmp)){\n    nation.m[i,ii] = tmp[ii]    \n  }\n}\n# export as data frame\nnation.df <- as.data.frame(nation.m)\nhead(nation.df)\n\n# export\n#write.csv(dat2.df, file = \"data/lon_data.csv\")\n#write.csv(unique(nation.l), file = 'data/nationalities.csv')\n#write.csv(unique(dat2.df$fname), file = 'data/fname_u.csv')\n#write.csv(unique(dat2.df$canonical_fname), file = 'data/canonincal_u.csv')\n#write.csv(unique(dat2.df$oname), file = 'data/oname_u.csv')\n\nrm(list=setdiff(ls(), \"dat2.df\"))",
    "created" : 1485768349349.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3846214847",
    "id" : "D689B3E8",
    "lastKnownWriteTime" : 1485769679,
    "last_content_update" : 1485769679294,
    "path" : "~/projects/lonsea/data.extract.R",
    "project_path" : "data.extract.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}